(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{403:function(s,a,n){"use strict";n.r(a);var e=n(42),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"master-slave"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#master-slave"}},[s._v("#")]),s._v(" Master-Slave")]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"为什么引入slave"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么引入slave"}},[s._v("#")]),s._v(" 为什么引入Slave")]),s._v(" "),n("p",[s._v("jenkins可以帮助我们拉取代码，代码检查，打包...等等工作。当我们在一台\njenkins服务器上午去执行时，会排队等待。而且很多都是文件IO操作，耗费性能\n大。所以我们需要将任务分配在slave上完成，以减轻master的压力。让master\n做为任务的调度中心，让slave成为计算节点。\n"),n("img",{attrs:{src:"/images/jenkins/jenkins9.png",alt:""}}),n("br")]),s._v(" "),n("h2",{attrs:{id:"slave节点准备"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#slave节点准备"}},[s._v("#")]),s._v(" Slave节点准备")]),s._v(" "),n("h3",{attrs:{id:"节点ip"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#节点ip"}},[s._v("#")]),s._v(" 节点IP")]),s._v(" "),n("p",[s._v("我这里准备两台slave为："),n("br"),s._v("\n192.168.163.112"),n("br"),s._v("\n192.168.163.113"),n("br"),s._v("\n两台机除了IP不一样，需要的软件环境都一样。以下操作请在两台机上均保持一致。")]),s._v(" "),n("h3",{attrs:{id:"安装jdk"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装jdk"}},[s._v("#")]),s._v(" 安装jdk")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('# 本站搜索jdk有安装示例\n[root@host112 ~]# java -version\njava version "1.8.0_231"\nJava(TM) SE Runtime Environment (build 1.8.0_231-b11)\nJava HotSpot(TM) 64-Bit Server VM (build 25.231-b11, mixed mode)\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"安装maven"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装maven"}},[s._v("#")]),s._v(" 安装Maven")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('# 本站搜索Maven有安装示例\n[root@host112 ~]# mvn -version\nApache Maven 3.5.0 (ff8f5e7444045639af65f6095c62210b5713f426; 2017-04-04T03:39:06+08:00)\nMaven home: /usr/local/maven/apache-maven-3.5.0\nJava version: 1.8.0_231, vendor: Oracle Corporation\nJava home: /usr/local/java/jdk1.8.0_231/jre\nDefault locale: en_US, platform encoding: UTF-8\nOS name: "linux", version: "3.10.0-1062.el7.x86_64", arch: "amd64", family: "unix"\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"安装git"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装git"}},[s._v("#")]),s._v(" 安装Git")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[root@host112 ~]# git --version\ngit version 1.8.3.1\n\n# 生成ssh凭证\n[root@host112 ~]# ssh-keygen\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/root/.ssh/id_rsa): \nCreated directory '/root/.ssh'.\nEnter passphrase (empty for no passphrase): \nEnter same passphrase again: \nYour identification has been saved in /root/.ssh/id_rsa.\nYour public key has been saved in /root/.ssh/id_rsa.pub.\nThe key fingerprint is:\nSHA256:ewycNw2c0nkg8DxO39jPhY7nyS1loy2jgbGuFAvGjXk root@host112\nThe key's randomart image is:\n+---[RSA 2048]----+\n|      ... .      |\n|       o + +     |\n|        * * .    |\n|    . ++ = B   . |\n|     * ES.= + . .|\n|    . o o=+. = oo|\n|       o.oo.. Bo.|\n|      . ..  .B.+ |\n|       ... .. *..|\n+----[SHA256]-----+\n# 打印ssh凭证\n[root@host112 ~]# cat .ssh/id_rsd.pub\ncat: .ssh/id_rsd.pub: No such file or directory\n[root@host112 ~]# cat .ssh/id_rsa.pub\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCyO+kgKwGSQdIZVC/Z7MU3skSeCNsvYcrSlHwM0Bw8MCamjjQYgQy8y8WHXX4L8Z6SWnE6LQj31Yl6828WK/RiWIxyaoCVvVgdZ21qc1vilxj5YItg2flQpQnCVmX5mKg37dHOqvkcz3Y9q+ibpayftd3a2nF0Bfv2ys3m5MY5cO9WXXf0Z2dvLDgkMnd/lBFpfa/HjxxeCg/hZ9pjmviqtT8tB/Lcqh3jsG6bc45wDMNvs54W1tQQmEhoBlvY09c5sJFRLxXUKusoBlIbFiXcFiYi/lP0YjgxyGoE7MFvTfw+uAzpXodinPm6XFofjDBgCFJMUrZaoR20IzN0PSEt root@host112\n\n# 将这个凭证放置在Git仓库服务器上\n# 以我这边为例，我这里用105做Git仓库服务器\n# 先在105上登录git : $ su - git \n# 编辑.ssh/authorized_keys 把上面生成的凭证加入进去\n# 113的凭证也如此做\n\n# 验证免密登录并clone\n[root@host112 ~]# git clone git@192.168.163.105:/home/git/repos/app.git\nCloning into 'app'...\nThe authenticity of host '192.168.163.105 (192.168.163.105)' can't be established.\nECDSA key fingerprint is SHA256:Nw2ekiMBaEVdz3FxqabFggQqG0LNIiVRRXa+cd9P+Is.\nECDSA key fingerprint is MD5:2e:af:fe:47:01:60:62:63:c4:fa:dc:14:d6:4e:7f:c9.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '192.168.163.105' (ECDSA) to the list of known hosts.\nremote: Counting objects: 6, done.\nremote: Compressing objects: 100% (3/3), done.\nremote: Total 6 (delta 0), reused 0 (delta 0)\nReceiving objects: 100% (6/6), done.\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br")])]),n("h3",{attrs:{id:"安装docker"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装docker"}},[s._v("#")]),s._v(" 安装Docker")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("先留着，到了需要打包镜像再回来补充\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"配置slave"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置slave"}},[s._v("#")]),s._v(" 配置Slave")]),s._v(" "),n("p",[n("img",{attrs:{src:"/images/jenkins/jenkin-6.gif",alt:""}}),n("br"),s._v("\n并发构建数：2  同一时间只允许两个job在构建。"),n("br"),s._v("\n远程工作目录：/opt/lib/jenkins  会在这个目录里面安装代理所需的jar,其他活动也在这个目录"),n("br"),s._v("\n用法：上面其实漏操作了，我们先用“只允许运行绑定到这台机器的JOB”测试，后面再改。"),n("br"),s._v("\n配置代理的主机名和账户密码：如果你的slave机的账户和密码都一样，配一个就行了。"),n("br"),s._v("\n高级栏目里面注意配置好该slave机上的JDK环境，比如我的：/usr/local/java/jdk1.8.0_231/bin/java"),n("br"),s._v("\n保存配置后，回到节点管理页面，可以点击节点名进去启动/断开。第一次连可能有点慢，\n需要安装agent的环境，jar包等。"),n("br")]),s._v(" "),n("h2",{attrs:{id:"slave构建测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#slave构建测试"}},[s._v("#")]),s._v(" Slave构建测试")]),s._v(" "),n("h3",{attrs:{id:"指定slave节点构建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#指定slave节点构建"}},[s._v("#")]),s._v(" 指定slave节点构建")]),s._v(" "),n("p",[n("img",{attrs:{src:"/images/jenkins/jenkin-7.gif",alt:""}}),n("br"),s._v("\n如上演示，我们指定slava-192.168.163.113这个名称的节点，jenkins就会去匹配。\n如果状态正常就像上面动图中所示的那样。之后构建，我们可以看到日志打印中，有\n构建的主机名，也有该主机上的工作目录输出。比如我这里："),n("br"),s._v("\nBuilding remotely on slave-192.168.163.113 in workspace /opt/lib/jenkins/workspace/test")]),s._v(" "),n("h3",{attrs:{id:"指定slave标签构建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#指定slave标签构建"}},[s._v("#")]),s._v(" 指定slave标签构建")]),s._v(" "),n("p",[n("img",{attrs:{src:"/images/jenkins/jenkin-8.gif",alt:""}}),n("br"),s._v("\n如上演示，给两台slave节点加上web标签。然后test任务指定节点为web标签。当对test\n构建时，jenkins会从web标签中找到一组slave,并根绝jenkins自身的算法挑出一个，来\n执行构建的具体任务。可以建多个job,同时去构建，可以看到job分在两个节点上执行。")])])}),[],!1,null,null,null);a.default=t.exports}}]);