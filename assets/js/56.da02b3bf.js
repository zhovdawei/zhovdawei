(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{410:function(s,n,a){"use strict";a.r(n);var e=a(42),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"理解pod对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#理解pod对象"}},[s._v("#")]),s._v(" 理解Pod对象")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"pod基本概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod基本概念"}},[s._v("#")]),s._v(" Pod基本概念")]),s._v(" "),a("p",[s._v("最小部署单元"),a("br"),s._v("\n一组容器的集合"),a("br"),s._v("\n一个Pod中的容器共享网络命名空间与存储"),a("br"),s._v("\nPod是短暂的"),a("br")]),s._v(" "),a("h2",{attrs:{id:"pod存在的意义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod存在的意义"}},[s._v("#")]),s._v(" Pod存在的意义")]),s._v(" "),a("p",[s._v("Pod为亲密性应用而存在。"),a("br"),s._v("\n亲密性应用场景："),a("br"),s._v("\n两个应用之间发生文件交互"),a("br"),s._v("\n两个应用需要用过127.0.0.1或者socket通信"),a("br"),s._v("\n两个应用需要发生频繁的调用"),a("br")]),s._v(" "),a("h3",{attrs:{id:"pod网络共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod网络共享"}},[s._v("#")]),s._v(" Pod网络共享")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 根据已经存在pod导出一个pod模板yaml文件\n[root@k8s-master ~]# kubectl get pod\nNAME                         READY   STATUS    RESTARTS   AGE\njava-demo-75899cf7b5-95clh   1/1     Running   1          22h\njava-demo-75899cf7b5-btrxb   1/1     Running   1          22h\njava-demo-75899cf7b5-w7jxt   1/1     Running   1          22h\nnginx-554b9c67f9-jnff8       1/1     Running   3          2d13h\n[root@k8s-master ~]# kubectl get pods java-demo-75899cf7b5-95clh -o yaml > pod.yaml\n\n# 编辑yaml文件，在一个pod中定义两个docker容器\n$ vi pod.yaml\n################################################################\napiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    app: my-pod\n  name: my-pod\n  namespace: default\nspec:\n  containers:\n  - image: java-demo\n    name: java\n    image: david0607/java-demo:latest\n  - image: nginx\n    name: nginx\n    image: nginx\n################################################################\n\n# 查看一下pods,发现与之前的pod相比，ready是2，这就说明2是根据你模板文件里面的容器数量来的\n[root@k8s-master ~]# kubectl get pods\nNAME                         READY   STATUS    RESTARTS   AGE\njava-demo-75899cf7b5-95clh   1/1     Running   1          23h\njava-demo-75899cf7b5-btrxb   1/1     Running   1          23h\njava-demo-75899cf7b5-w7jxt   1/1     Running   1          23h\nmy-pod                       2/2     Running   0          26s\nnginx-554b9c67f9-jnff8       1/1     Running   3          2d15h\n\n################################ 查看java容器的ip ################################\n[root@k8s-master ~]# kubectl exec -it my-pod -c java bash\n[root@my-pod tomcat]# ifconfig \neth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1450\n        inet 10.244.2.9  netmask 255.255.255.0  broadcast 0.0.0.0\n        ether d2:86:92:46:5c:85  txqueuelen 0  (Ethernet)\n        RX packets 9  bytes 698 (698.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 1  bytes 42 (42.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 0  bytes 0 (0.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 0  bytes 0 (0.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n        \n################################ 查看nginx容器的ip ################################\n# 查看nginx容器，由于是精简容器，你需要安装ifconfig命令\n[root@k8s-master ~]# kubectl exec -it my-pod -c nginx bash\nroot@my-pod:/# ifconfig\nbash: ifconfig: command not found\nroot@my-pod:/# cat /etc/issue\nDebian GNU/Linux 10 \\n \\l\n\n# 更新+安装\nroot@my-pod:/# apt-get update\nroot@my-pod:/# apt install net-tools\n\nroot@my-pod:/# ifconfig\neth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1450\n        inet 10.244.2.9  netmask 255.255.255.0  broadcast 0.0.0.0\n        ether d2:86:92:46:5c:85  txqueuelen 0  (Ethernet)\n        RX packets 11654  bytes 9083650 (8.6 MiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 5953  bytes 324687 (317.0 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 0  bytes 0 (0.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 0  bytes 0 (0.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\n################################ 结论 ################################\npod内的一组容器共享网络\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br")])]),a("p",[s._v("那么问题来了：pod是如何实现内部网络共享的呢？")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# 查看一下 my-pod分布在哪个节点上\n[root@k8s-master ~]# kubectl get pods -o wide\nNAME                         READY   STATUS    RESTARTS   AGE     IP            NODE        NOMINATED NODE   READINESS GATES\njava-demo-75899cf7b5-95clh   1/1     Running   1          24h     10.244.2.4    k8s-node2   <none>           <none>\njava-demo-75899cf7b5-btrxb   1/1     Running   1          24h     10.244.1.8    k8s-node1   <none>           <none>\njava-demo-75899cf7b5-w7jxt   1/1     Running   1          24h     10.244.2.5    k8s-node2   <none>           <none>\nmy-pod                       2/2     Running   0          18m     10.244.2.9    k8s-node2   <none>           <none>\nnginx-554b9c67f9-jnff8       1/1     Running   3          2d15h   10.244.1.10   k8s-node1   <none>           <none>\n\n# 查看容器\n# 可以发现这三个容器是在同一个pod下的（逻辑上的约束）\n[root@k8s-node2 ~]# docker ps\nCONTAINER ID        IMAGE                                               COMMAND                  CREATED             STATUS              PORTS               NAMES\n4a503d9ee291        nginx                                               "nginx -g \'daemon of…"   19 minutes ago      Up 19 minutes                           k8s_nginx_my-pod_default_bdac93e9-8908-4da7-9657-080f48ef5d12_0\nd70680975b10        david0607/java-demo                                 "catalina.sh run"        19 minutes ago      Up 19 minutes                           k8s_java_my-pod_default_bdac93e9-8908-4da7-9657-080f48ef5d12_0\ne6c2f867bdb6        registry.aliyuncs.com/google_containers/pause:3.1   "/pause"                 19 minutes ago      Up 19 minutes                           k8s_POD_my-pod_default_bdac93e9-8908-4da7-9657-080f48ef5d12_0\n\n################################ 结论 ################################\ndocker网络管理中，容器的网络可以指定另一个容器的网络，然后多个容器共享一个网络。\n这里的pause容器就是用来创建网络约束的，java和nginx都加入它，三者共享一个网络。\npause是pod默认创建的容器。\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("h3",{attrs:{id:"pod存储共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod存储共享"}},[s._v("#")]),s._v(" Pod存储共享")]),s._v(" "),a("p",[s._v("pod从崩溃到恢复，如果数据没有持久化，恢复后的pod就是一个新生儿。"),a("br"),s._v("\n这显然不是我们希望的，我们希望数据得到持久化。"),a("br"),s._v("\n需要持久化的数据："),a("br"),s._v("\n1.临时数据"),a("br"),s._v("\n2.日志"),a("br"),s._v("\n3.业务数据"),a("br"),s._v("\n如果pod内的多个容器是亲和性高的，比如一个生产数据，一个读取数据，那么就需要做数据共享。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# 可以执行下面这个pod模板，验证数据共享\napiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\nspec:\n  containers:\n  - name: write\n    image: centos\n    command: ["bash","-c","for i in {1..100};do echo $i >> /data/hello;sleep 1;done"]\n    volumeMounts:\n      - name: data\n        mountPath: /data\n  - name: read\n    image: centos\n    command: ["bash","-c","tail -f /data/hello"]\n    volumeMounts:\n    - name: data\n      mountPath: /data\nvolumes:\n- name: data\n  emptyDir: {}\n  \n# 上面的数据共享，是两个容器的/data目录挂载到pod所在节点的一个emptyDir类型的数据卷上，从而实现数据的共享\n# emptyDir 是一个空目录，跟随pod的生命周期\n# pod崩溃不是死亡，emptyDir依然存在，pod恢复后，容器可以从emptyDir恢复数据\n# pod移除，emptyDir也随之丢失\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("p",[a("a",{attrs:{href:"https://www.kubernetes.org.cn/kubernetes-volumes",target:"_blank",rel:"noopener noreferrer"}},[s._v("更多Volume参数设置"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"pod容器分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod容器分类"}},[s._v("#")]),s._v(" Pod容器分类")]),s._v(" "),a("h3",{attrs:{id:"infrastructure-container-基础容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#infrastructure-container-基础容器"}},[s._v("#")]),s._v(" Infrastructure Container 基础容器")]),s._v(" "),a("p",[s._v("维护整个Pod网络空间"),a("br")]),s._v(" "),a("h3",{attrs:{id:"initcontainers-初始化容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#initcontainers-初始化容器"}},[s._v("#")]),s._v(" InitContainers 初始化容器")]),s._v(" "),a("p",[s._v("先于业务容器执行"),a("br")]),s._v(" "),a("h3",{attrs:{id:"containers-业务容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#containers-业务容器"}},[s._v("#")]),s._v(" Containers 业务容器")]),s._v(" "),a("p",[s._v("并行启动"),a("br")]),s._v(" "),a("h2",{attrs:{id:"pod模板"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod模板"}},[s._v("#")]),s._v(" Pod模板")]),s._v(" "),a("p",[a("img",{attrs:{src:"/images/k8s/k8s8.png",alt:""}}),a("br")]),s._v(" "),a("h3",{attrs:{id:"变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#变量"}},[s._v("#")]),s._v(" 变量")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('env:\n  - name: JAVA_OPTS\n    value: "-Xmx1g"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("设置jvm的变量")]),s._v(" "),a("h3",{attrs:{id:"拉取镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#拉取镜像"}},[s._v("#")]),s._v(" 拉取镜像")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("spec:\n  imagePullSecrets:\n  - name: registry-pull-secret\n  containers:\n  - name: product\n    image: 192.168.31.70/microservice/product:2019-07-10-21-34-34\n    imagePullPolicy: Always\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[s._v("name: registry-pull-secret 指定我们从指定私有镜像库拉取镜像时需要的的认证"),a("br"),s._v("\nimage: 192.168.31.70/microservice/product:2019-07-10-21-34-34 指定镜像仓库和镜像名已经版本(tag)")])]),s._v(" "),a("h3",{attrs:{id:"资源限制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资源限制"}},[s._v("#")]),s._v(" 资源限制")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("resources:\n  # 运行时资源\n  requests:\n    cpu: 0.5\n    memory: 256Mi\n  # 资源阈值，超过会杀掉进程重启\n  limits:\n    cpu: 1\n    memory: 1Gi\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"健康检查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#健康检查"}},[s._v("#")]),s._v(" 健康检查")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 判断是否准备完成，否则重建恢复\nreadinessProbe:\n  tcpSocket:\n    port: 8010\n  initialDelaySeconds: 60\n  periodSeconds: 10\n# 没准备就不转发流量\nlivenessProbe:\n  tcpSocket:\n    port: 8010\n  initialDelaySeconds: 60\n  periodSeconds: 10\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);