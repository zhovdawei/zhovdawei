(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{372:function(s,a,n){"use strict";n.r(a);var e=n(42),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"elasticsearch的配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch的配置文件"}},[s._v("#")]),s._v(" ElasticSearch的配置文件")]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"三个配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三个配置文件"}},[s._v("#")]),s._v(" 三个配置文件")]),s._v(" "),n("p",[s._v("在ElasticSearch目录下config目录中")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[david@host114 elasticsearch-7.5.0]$ ll config/\n...\n-rw-rw----. 1 david root  2818 Jan 13 18:37 elasticsearch.yml\n-rw-rw----. 1 david root  2204 Jan 13 17:48 jvm.options\n-rw-rw----. 1 david root 17545 Nov 26 09:10 log4j2.properties\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("elasticsearch应用的相关配置 elasticsearch.yml "),n("br"),s._v("\njvm参数配置 jvm.options"),n("br"),s._v("\n日志管理配置 log4j2.properties"),n("br")]),s._v(" "),n("h2",{attrs:{id:"配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),n("h3",{attrs:{id:"elasticsearch-yml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-yml"}},[s._v("#")]),s._v(" elasticsearch.yml")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("cluster.name 指定一个集群名\nnode.name 指定当前应用实例的节点名\nnetwork.host 绑定节点的IP\nhttp.port 绑定节点的端口(除非默认端口9200被占用，否则不建议改)\npath.data 指定当前节点的数据储存路径\npath.logs 指定当前节点的日志存储路径\n\n\n# 注意：如果network.host绑定了具体的IP。则应用以production模式启动，启动中\n检查不满足生产要求，会出现Error报错，就像上一篇安装时的一些报错。\n如果是localhost/127.0.0.1,则为Development模式，启动检查不符合要求，是warning警告日志。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h3",{attrs:{id:"jvm-options"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jvm-options"}},[s._v("#")]),s._v(" jvm.options")]),s._v(" "),n("p",[s._v("因为ElasticSearch是用Java开发的应用，所以我们需要关注虚拟机的资源分配和垃圾回收。\n该配置文件需要关注的点："),n("br")]),s._v(" "),n("p",[s._v("1.堆的大小 "),n("br"),s._v("\n官方的实例建议我们把堆的初始值和最大值配置一样，这样堆就是个固定值，这样有一个好处：\n当堆内对象持续增长时可以避免扩容带来的full GC。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("-Xms1g\n-Xmx1g\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("2.设置GC")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 默认的GC配置\n## GC configuration\n# 使用ParNew + CMS + Serial Old 的收集器组合进行内存回收。\n# Serial Old收集器将作为CMS收集器出现Concurrent Mode Failure失败后的后备收集器使用\n-XX:+UseConcMarkSweepGC \n# 设置当老年代空间占用达到75%开始执行垃圾回收\n-XX:CMSInitiatingOccupancyFraction=75\n# 设置CMS只根据老年代空间占用指标来决定是否触发回收\n-XX:+UseCMSInitiatingOccupancyOnly\n\n\n# G1垃圾收集器配置，当你的JDK版本 >= 10\n## G1GC Configuration\n# NOTE: G1GC is only supported on JDK version 10 or later.\n# To use G1GC uncomment the lines below.\n# 10-:-XX:-UseConcMarkSweepGC\n# 10-:-XX:-UseCMSInitiatingOccupancyOnly\n# 10-:-XX:+UseG1GC\n# 10-:-XX:G1ReservePercent=25\n# 10-:-XX:InitiatingHeapOccupancyPercent=30\n\n# 上面的垃圾回收参数可以自定义，比如JDK8就提供了G1，需要手动解锁开启\n# 你可以忽略JDK版本统一使用G1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("p",[s._v("3.开启堆转储快照")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 官方是默认开启了，作用就是发生堆溢出时，保存了当时的现场情况，便于事后分析\n-XX:+HeapDumpOnOutOfMemoryError\n\n# 保存堆转储文件到指定的目录\n-XX:HeapDumpPath=data\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ol",{attrs:{start:"4"}},[n("li",[s._v("JVM日志")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# JVM-error日志存储路径\n-XX:ErrorFile=logs/hs_err_pid%p.log\n\n# JDK8 GC日志配置\n## JDK 8 GC logging\n8:-XX:+PrintGCDetails\n8:-XX:+PrintGCDateStamps\n8:-XX:+PrintTenuringDistribution\n8:-XX:+PrintGCApplicationStoppedTime\n8:-Xloggc:logs/gc.log\n8:-XX:+UseGCLogFileRotation\n8:-XX:NumberOfGCLogFiles=32\n8:-XX:GCLogFileSize=64m\n\n# JDK>=9 GC日志配置\n# JDK 9+ GC logging\n9-:-Xlog:gc*,gc+age=trace,safepoint:file=logs/gc.log:utctime,pid,tags:filecount=32,filesize=64m\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h3",{attrs:{id:"log4j2-properties"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#log4j2-properties"}},[s._v("#")]),s._v(" log4j2.properties")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("status = error\n\n# log action execution errors for easier debugging\nlogger.action.name = org.elasticsearch.action\nlogger.action.level = debug\n\nappender.console.type = Console\nappender.console.name = console\nappender.console.layout.type = PatternLayout\nappender.console.layout.pattern = [%d{ISO8601}][%-5p][%-25c{1.}] [%node_name]%marker %m%n\n...\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("配置了ElasticSearch的日志级别，日志格式等。用过Java开发，对这一块应该不会陌生。")]),s._v(" "),n("h2",{attrs:{id:"命令参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#命令参数"}},[s._v("#")]),s._v(" 命令参数")]),s._v(" "),n("p",[s._v("可以在启动命令添加参数修改，如下："),n("br"),s._v("\nbin/elasticsearch -Ehttp.port=29000")])])}),[],!1,null,null,null);a.default=t.exports}}]);